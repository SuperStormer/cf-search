{"version":3,"file":"index.js","mappings":"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","sources":["webpack://cf-search/./src/scripts/consts.js","webpack://cf-search/./src/scripts/utils.js","webpack://cf-search/./src/scripts/api.js","webpack://cf-search/./src/scripts/dropdowns.js","webpack://cf-search/./src/scripts/filters.js","webpack://cf-search/./src/scripts/results.js","webpack://cf-search/./src/scripts/index.js"],"sourcesContent":["// I'm assuming this is safe b/c ferium does the same thing ¯\\_(ツ)_/¯\n// https://github.com/gorilla-devs/ferium/blob/f9bf7906fde4938255bd4e9d95a680ac5646c0b4/src/main.rs#L95\nexport const API_KEY = \"$2a$10$3kFa9lBWciEK.lsp7NyCSupZ3XmlAYixZQ9fTczqsz1/.W9QDnLUy\";\nexport const GAME_ID = 432;\nexport const MODLOADERS = [\"Any\", \"Forge\", \"Cauldron\", \"LiteLoader\", \"Fabric\", \"Quilt\"].map(\n\t(v, i) => [v, i]\n);\nexport const SORT_FIELDS = [\n\t\"Featured\",\n\t\"Popularity\",\n\t\"Last Updated\",\n\t\"Name\",\n\t\"Author\",\n\t\"Total Downloads\",\n\t\"Category\",\n\t\"Game Version\",\n].map((v, i) => [v, i + 1]);\nexport const SORT_ORDERS = [\"asc\", \"desc\"].map((v) => [v, v]);\n","/* utility functions */\n// https://stackoverflow.com/a/34890276\nexport function group_by(xs, key) {\n\treturn xs.reduce(function (rv, x) {\n\t\t(rv[x[key]] = rv[x[key]] || []).push(x);\n\t\treturn rv;\n\t}, {});\n}\n\n// https://stackoverflow.com/a/50636286\nexport function partition(array, filter) {\n\tlet pass = [],\n\t\tfail = [];\n\tarray.forEach((e, idx, arr) => (filter(e, idx, arr) ? pass : fail).push(e));\n\treturn [pass, fail];\n}\n\n// based on https://stackoverflow.com/a/4499062\nexport function human_readable(number) {\n\tif (number < 1000) {\n\t\treturn number.toString();\n\t} else if (number < 1000 * 1000) {\n\t\treturn (number / 1000).toFixed(1) + \"K\";\n\t} else {\n\t\treturn (number / 1000 / 1000).toFixed(1) + \"M\";\n\t}\n}\n\nexport function natural_sort(array) {\n\treturn array.sort((a, b) => a.name.localeCompare(b.name, undefined, { numeric: true }));\n}\n\nexport function format_categories(array, class_id) {\n\tlet subcategories = group_by(array, \"parentCategoryId\");\n\tlet top_level = subcategories[class_id];\n\tdelete subcategories[class_id];\n\n\ttop_level.sort((a, b) => a.name.localeCompare(b.name, undefined, { numeric: true }));\n\n\tfor (let [id, subcategory] of Object.entries(subcategories)) {\n\t\tid = parseInt(id, 10);\n\t\tsubcategory.sort((a, b) => a.name.localeCompare(b.name, undefined, { numeric: true }));\n\t\tsubcategory.forEach((x) => {\n\t\t\tx.name = \" └ \" + x.name;\n\t\t});\n\n\t\t// insert subcategories below top level category\n\t\tlet i = top_level.findIndex((x) => x.id === id);\n\t\ttop_level.splice(i + 1, 0, ...subcategory);\n\t}\n\treturn top_level;\n}\n\nexport function sort_vers(versions) {\n\treturn versions\n\t\t.filter((x) => x.name.startsWith(\"Minecraft\")) //TODO figure out why other versions don't work and remove this temp fix\n\t\t.sort((a, b) => {\n\t\t\ta = a.name;\n\t\t\tb = b.name;\n\t\t\tif (a.startsWith(\"Minecraft\")) {\n\t\t\t\tif (b.startsWith(\"Minecraft\")) {\n\t\t\t\t\tif (a === \"Minecraft Beta\") {\n\t\t\t\t\t\treturn 1;\n\t\t\t\t\t} else if (b === \"Minecraft Beta\") {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn -a.localeCompare(b, undefined, { numeric: true });\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (b.startsWith(\"Minecraft\")) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn a.localeCompare(b, undefined, { numeric: true });\n\t\t});\n}\n\nexport function sort_subvers(subvers) {\n\treturn subvers.sort((a, b) => {\n\t\tif (a.endsWith(\"Snapshot\")) {\n\t\t\treturn 1;\n\t\t} else if (b.endsWith(\"Snapshot\")) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn -a.localeCompare(b, undefined, { numeric: true });\n\t});\n}\n","import { API_KEY } from \"./consts\";\nexport async function cf_api(endpoint, params, additional_args) {\n\tif (typeof params === \"object\" && !(params instanceof URLSearchParams)) {\n\t\tparams = new URLSearchParams(params);\n\t} else if (params == undefined) {\n\t\tparams = \"\";\n\t}\n\n\tif (endpoint.startsWith(\"/\")) {\n\t\tendpoint = endpoint.slice(1);\n\t}\n\n\treturn fetch(\"https://api.curseforge.com/\" + endpoint + \"?\" + params, {\n\t\theaders: { \"x-api-key\": API_KEY, accept: \"application/json\" },\n\t\t...additional_args,\n\t})\n\t\t.then((resp) => resp.json())\n\t\t.then((json) => json.data);\n}\n","import { natural_sort, group_by, format_categories, sort_vers } from \"./utils\";\nimport { GAME_ID } from \"./consts\";\nimport { cf_api } from \"./api\";\n\n/* populate dropdowns */\nexport function populate_dropdown(dropdown, values, defaultValue) {\n\tdropdown.innerHTML = \"\";\n\tlet fragment = document.createDocumentFragment();\n\n\tfor (let [name, value] of values) {\n\t\tlet option = document.createElement(\"option\");\n\t\toption.value = value;\n\t\toption.textContent = name;\n\t\tfragment.append(option);\n\t}\n\n\tdropdown.append(fragment);\n\n\tif (defaultValue == undefined) {\n\t\t// if no default value is specified, create a default option with the category name\n\t\t// based on https://stackoverflow.com/a/8442831\n\t\tlet defaultOption = document.createElement(\"option\");\n\t\tdefaultOption.value = \"\";\n\t\tdefaultOption.selected = true;\n\t\tdefaultOption.textContent = dropdown.dataset.name;\n\t\tdropdown.dataset.default = \"\";\n\t\tdropdown.prepend(defaultOption);\n\t} else {\n\t\t// otherwise, select the corresponding <option>\n\t\tlet option = Array.from(dropdown.options).find((x) => x.textContent === defaultValue);\n\t\tdropdown.dataset.default = option.value;\n\t\toption.selected = true;\n\t\tdropdown.dispatchEvent(new Event(\"change\"));\n\t}\n}\n\n/* fetch dropdown values from CF API */\nasync function fetch_categories() {\n\tlet categories = await cf_api(\"/v1/categories\", { gameId: GAME_ID });\n\tcategories = group_by(categories, \"classId\");\n\n\tlet classes = natural_sort(categories[undefined]);\n\tdelete categories[undefined];\n\n\t// ignore bukkit plugins, customizations, addons\n\t// API doesn't work and I don't feel like figuring out why\n\tlet brokenClasses = [5, 4546, 4559, 4979];\n\tfor (let id of brokenClasses) {\n\t\tdelete categories[id];\n\t}\n\tclasses = classes.filter((x) => !brokenClasses.includes(x.id));\n\n\t// format categories\n\tfor (let class_ in categories) {\n\t\tcategories[class_] = format_categories(categories[class_], class_);\n\t}\n\n\t// ignore Fabric, FancyMenu, QoL, Vanilla+ tags\n\t// these tags don't exist anymore, idk why they're still in the API\n\tlet brokenModCategories = new Set([5192, 4780, 5190, 5129]);\n\tcategories[6] = categories[6].filter((x) => !brokenModCategories.has(x.id));\n\treturn [classes, categories];\n}\n\nasync function fetch_vers() {\n\treturn sort_vers(await cf_api(`/v1/games/${GAME_ID}/version-types`));\n}\n\nfunction fetch_subvers() {\n\treturn cf_api(`/v1/games/${GAME_ID}/versions`);\n}\n\n// fetch in parallel and cache\nexport async function fetch_dropdown_values() {\n\tlet cache_time = localStorage.getItem(\"cache_time\");\n\tlet now = Date.now();\n\tlet classes, categories, versions, sub_versions;\n\tif (!cache_time || now - cache_time > 24 * 60 * 60 * 1000) {\n\t\tlet result = await Promise.all([fetch_categories(), fetch_vers(), fetch_subvers()]);\n\t\t[[classes, categories], versions, sub_versions] = result;\n\t\tlocalStorage.setItem(\"cache\", JSON.stringify(result));\n\t\tlocalStorage.setItem(\"cache_time\", now);\n\t} else {\n\t\t[[classes, categories], versions, sub_versions] = JSON.parse(localStorage.getItem(\"cache\"));\n\t}\n\treturn [classes, categories, versions, sub_versions];\n}\n","/* handle visual filters */\nimport { partition } from \"./utils\";\nexport function populate_filters(filters_el, categories, checked_callback) {\n\tfilters_el.innerHTML = \"\";\n\tlet fragment = document.createDocumentFragment();\n\n\tfor (let [category, id] of categories) {\n\t\tlet el = document.createElement(\"label\");\n\n\t\tlet checkbox = document.createElement(\"input\");\n\t\tcheckbox.type = \"checkbox\";\n\t\tcheckbox.name = category;\n\t\tcheckbox.value = id;\n\n\t\tcheckbox.addEventListener(\"change\", function (event) {\n\t\t\t// custom checkbox behavior for filters\n\t\t\t// cycle from off, include, exclude\n\t\t\tlet el = event.target;\n\t\t\tif (!el.dataset.value || el.dataset.value === \"off\") {\n\t\t\t\t// off -> include\n\t\t\t\tel.checked = true;\n\t\t\t\tel.indeterminate = false;\n\t\t\t\tel.dataset.value = \"include\";\n\t\t\t} else if (el.dataset.value === \"include\") {\n\t\t\t\t// include -> exclude\n\t\t\t\tel.indeterminate = true;\n\t\t\t\tel.checked = true;\n\t\t\t\tel.dataset.value = \"exclude\";\n\t\t\t} else {\n\t\t\t\t// exclude -> off\n\t\t\t\tel.checked = false;\n\t\t\t\tel.indeterminate = false;\n\t\t\t\tel.dataset.value = \"off\";\n\t\t\t}\n\n\t\t\t// handle filtering\n\t\t\tlet params = new URLSearchParams(window.location.search);\n\t\t\tlet [include, exclude] = get_active_filters(filters_el);\n\n\t\t\tparams.set(\"filtersInclude\", include.join(\" \"));\n\t\t\tparams.set(\"filtersExclude\", exclude.join(\" \"));\n\t\t\thistory.pushState({}, \"\", \"?\" + params);\n\n\t\t\tchecked_callback();\n\t\t});\n\n\t\tlet label = document.createTextNode(category);\n\t\tel.append(checkbox, label);\n\t\tfragment.append(el);\n\t}\n\n\tfilters_el.append(fragment);\n}\n\nexport function get_active_filters(filters_el) {\n\tlet filters = Array.from(filters_el.elements).filter((x) => x.checked);\n\tlet [include, exclude] = partition(filters, (x) => x.dataset.value === \"include\");\n\treturn [include.map((x) => parseInt(x.value, 10)), exclude.map((x) => parseInt(x.value, 10))];\n}\n\nexport function filter_results(results, include, exclude) {\n\t// handle includes\n\tif (include.length > 0) {\n\t\tresults = results.filter((result) =>\n\t\t\tinclude.every((id) => result.categories.find((category) => category.id == id))\n\t\t);\n\t}\n\n\t//handle excludes\n\tif (exclude.length > 0) {\n\t\tresults = results.filter((result) =>\n\t\t\tresult.categories.every((category) => !exclude.includes(category.id))\n\t\t);\n\t}\n\n\treturn results;\n}\n","import { get_active_filters, filter_results } from \"./filters\";\nimport { GAME_ID } from \"./consts\";\nimport { cf_api } from \"./api\";\nimport { human_readable } from \"./utils\";\n\nlet search_results = [];\n// prevent double update_results with an AbortController\nlet current_ac = null;\nexport let current_updating_event = \"\";\n\nexport async function update_results(\n\tresults_el,\n\tsearch_form,\n\tfilters_el,\n\tloading_indicator,\n\tpage,\n\tevent_name,\n\tshow_ids\n) {\n\tif (current_ac !== null) {\n\t\tcurrent_ac.abort();\n\t}\n\tcurrent_ac = new AbortController();\n\tcurrent_updating_event = event_name;\n\n\tlet params = new URLSearchParams(new FormData(search_form));\n\n\t// update query params if not already set\n\tif (![\"default\", \"reset\", \"popstate\"].includes(current_updating_event)) {\n\t\tlet params2 = new URLSearchParams(params);\n\n\t\t// don't overwrite filters query params\n\t\tlet [include, exclude] = get_active_filters(filters_el);\n\t\tparams2.set(\"filtersInclude\", include.join(\" \"));\n\t\tparams2.set(\"filtersExclude\", exclude.join(\" \"));\n\t\tif (window.location.search !== \"?\" + params2.toString()) {\n\t\t\thistory.pushState({}, \"\", \"?\" + params2.toString());\n\t\t}\n\t}\n\n\tparams.append(\"gameId\", GAME_ID);\n\n\t// work-around for curseforge API being bad\n\tif (params.get(\"gameVersion\") && params.get(\"modLoaderType\") === \"0\") {\n\t\tparams.delete(\"modLoaderType\");\n\t}\n\n\tloading_indicator.hidden = false;\n\tresults_el.innerHTML = \"\";\n\n\tsearch_results = [];\n\ttry {\n\t\t// since CF API only lets us fetch 50 at a time,\n\t\t// this horrible code splits the desired pageSize into multiple requests\n\t\tlet queries = [];\n\t\tlet page_size = Number.parseInt(params.get(\"pageSize\"), 10);\n\n\t\tfor (let offset = 0; offset < page_size; offset += 50) {\n\t\t\tlet real_page_size = Math.min(50, page_size - offset);\n\t\t\tlet params2 = new URLSearchParams(params);\n\n\t\t\t// index is the index of the first item to include in the response\n\t\t\tlet index = page_size * page + offset;\n\n\t\t\tparams2.set(\"index\", index);\n\t\t\tparams2.set(\"pageSize\", real_page_size);\n\n\t\t\tqueries.push(cf_api(\"/v1/mods/search\", params2, { signal: current_ac.signal }));\n\t\t}\n\t\t// await each query sequentially to ensure result elements are properly ordered\n\t\tlet query_results = [];\n\t\tfor (let query of queries) {\n\t\t\tlet query_result = await query;\n\t\t\tconsole.log(query_result);\n\t\t\tpopulate_results(results_el, filters_el, query_result, show_ids);\n\t\t\tquery_results.push(query_result);\n\t\t}\n\t\tsearch_results = query_results.flat();\n\n\t\tloading_indicator.hidden = true;\n\n\t\tcurrent_ac = null;\n\t\tcurrent_updating_event = null;\n\t} catch (error) {\n\t\tif (error.name !== \"AbortError\") {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nexport function populate_results(results_el, filters_el, results, show_ids) {\n\tlet [include, exclude] = get_active_filters(filters_el);\n\tresults = filter_results(results, include, exclude);\n\n\tlet fragment = document.createDocumentFragment();\n\tfor (let result of results) {\n\t\tlet li = document.createElement(\"li\");\n\t\tli.className = \"result\";\n\n\t\t//title\n\t\tlet title = document.createElement(\"a\");\n\t\ttitle.className = \"result-title\";\n\t\ttitle.href = result.links.websiteUrl;\n\t\ttitle.textContent = result.name;\n\n\t\t// subtitle\n\t\tlet secondary = document.createElement(\"div\");\n\t\tsecondary.className = \"result-secondary\";\n\t\tlet downloads = document.createElement(\"span\");\n\t\tdownloads.textContent = `${human_readable(result.downloadCount)} Downloads`;\n\t\tlet updated = document.createElement(\"span\");\n\t\tupdated.textContent = `Updated ${new Date(result.dateModified).toLocaleDateString()}`;\n\t\tlet created = document.createElement(\"span\");\n\t\tcreated.textContent = `Created ${new Date(result.dateCreated).toLocaleDateString()}`;\n\t\tsecondary.append(downloads, updated, created);\n\n\t\t// summary\n\t\tlet summary = document.createElement(\"p\");\n\t\tsummary.className = \"result-summary\";\n\t\tsummary.textContent = result.summary;\n\n\t\t// category images\n\t\tlet categories = document.createElement(\"div\");\n\t\tcategories.className = \"result-categories\";\n\t\tfor (let category of result.categories) {\n\t\t\t// TODO change link to change form param instead\n\t\t\tlet el = document.createElement(\"a\");\n\t\t\tel.href = category.url;\n\n\t\t\tlet img = document.createElement(\"img\");\n\t\t\timg.className = \"result-category-image\";\n\t\t\timg.src = category.iconUrl;\n\t\t\timg.title = category.name;\n\n\t\t\tel.append(img);\n\t\t\tcategories.append(el);\n\t\t}\n\n\t\t//logo\n\t\tlet logo = document.createElement(\"img\");\n\t\tlogo.className = \"result-logo\";\n\t\tif (result.logo) {\n\t\t\tlogo.src = result.logo.thumbnailUrl;\n\t\t}\n\t\tlogo.alt = \"\";\n\n\t\tlet id = document.createElement(\"span\");\n\t\tid.className = \"project-id\";\n\t\tid.textContent = `Project ID: ${result.id}`;\n\n\t\tli.append(logo, categories, id, title, secondary, summary);\n\t\tfragment.append(li);\n\t}\n\tresults_el.append(fragment);\n}\n\nexport function populate_results_delayed(results_el, filters_el, show_ids) {\n\tresults_el.innerHTML = \"\";\n\t// setTimeout to avoid delay in checkbox visual update for large lists\n\tsetTimeout(() => populate_results(results_el, filters_el, search_results, show_ids), 0);\n}\n","import { MODLOADERS, SORT_FIELDS, SORT_ORDERS } from \"./consts\";\nimport { sort_subvers } from \"./utils\";\nimport { populate_dropdown, fetch_dropdown_values } from \"./dropdowns\";\nimport {\n\tcurrent_updating_event,\n\tpopulate_results_delayed,\n\tupdate_results as _update_results,\n} from \"./results\";\nimport { populate_filters as _populate_filters } from \"./filters\";\n(async function () {\n\tconst by_id = document.getElementById.bind(document);\n\tconst search_form = by_id(\"search-form\");\n\tconst classes_el = by_id(\"classes\");\n\tconst categories_el = by_id(\"categories\");\n\tconst modloader_el = by_id(\"modloader\");\n\tconst version_el = by_id(\"version\");\n\tconst sub_version_el = by_id(\"sub-version\");\n\tconst sort_field_el = by_id(\"sort-field\");\n\tconst sort_order_el = by_id(\"sort-order\");\n\tconst results_el = by_id(\"results\");\n\tconst page_size_el = by_id(\"page-size\");\n\tconst page_els = document.getElementsByClassName(\"page\");\n\tconst loading_indicator = by_id(\"loading-indicator\");\n\tconst reset_button = by_id(\"reset\");\n\tconst filters_el = by_id(\"filters\");\n\tconst show_ids = by_id(\"show-ids\");\n\n\tconst update_results = (event_name) => {\n\t\tconsole.log(show_ids.checked);\n\t\t_update_results(\n\t\t\tresults_el,\n\t\t\tsearch_form,\n\t\t\tfilters_el,\n\t\t\tloading_indicator,\n\t\t\tpage,\n\t\t\tevent_name,\n\t\t\tshow_ids.checked\n\t\t);\n\t};\n\tconst populate_filters = _populate_filters.bind(_populate_filters, filters_el);\n\n\tlet page = 0;\n\t// avoid triggering update_results when you trigger change event programmatically\n\t// (in order to populate dropdowns for prefill and defai;t)\n\tlet should_update = false;\n\n\t/* utility functions */\n\n\tlet [classes, categories, versions, sub_versions] = await fetch_dropdown_values();\n\n\t// categories\n\tpopulate_dropdown(categories_el, []);\n\n\tclasses_el.addEventListener(\"change\", function () {\n\t\tupdate_modloader();\n\n\t\tlet class_ = classes_el.value;\n\n\t\tlet categories2 = categories[class_].map((category) => [category.name, category.id]);\n\t\tpopulate_dropdown(categories_el, categories2);\n\t\tpopulate_filters(\n\t\t\tcategories2,\n\t\t\tpopulate_results_delayed.bind(\n\t\t\t\tpopulate_results_delayed,\n\t\t\t\tresults_el,\n\t\t\t\tfilters_el,\n\t\t\t\tshow_ids.checked\n\t\t\t)\n\t\t);\n\t});\n\n\t// classes\n\tpopulate_dropdown(\n\t\tclasses_el,\n\t\tclasses.map((x) => [x.name, x.id]),\n\t\t\"Mods\"\n\t);\n\n\t// modloaders\n\tpopulate_dropdown(modloader_el, MODLOADERS, \"Any\");\n\n\tsub_version_el.addEventListener(\"change\", function () {\n\t\tupdate_modloader();\n\t});\n\n\tfunction disable_modloader() {\n\t\tmodloader_el.title = modloader_el.dataset.title;\n\t\tmodloader_el.disabled = true;\n\t}\n\n\tfunction enable_modloader() {\n\t\tmodloader_el.title = \"\";\n\t\tmodloader_el.disabled = false;\n\t}\n\n\tfunction update_modloader() {\n\t\tif (classes_el.value === \"6\" && sub_version_el.value !== \"\") {\n\t\t\t// if mods is selected and a subver is selected,\n\t\t\t// enable the modloader dropdown\n\t\t\tenable_modloader();\n\t\t} else {\n\t\t\tdisable_modloader();\n\t\t}\n\t}\n\t// versions\n\tpopulate_dropdown(\n\t\tversion_el,\n\t\tversions.map((version) => [version.name, version.id])\n\t);\n\n\t// sub versions\n\tpopulate_dropdown(sub_version_el, []);\n\n\tversion_el.addEventListener(\"change\", function () {\n\t\tdisable_modloader();\n\n\t\tlet val = version_el.value;\n\n\t\t// reset subvers dropdown if version was deselected\n\t\tif (val === \"\") {\n\t\t\tpopulate_dropdown(sub_version_el, []);\n\t\t\treturn;\n\t\t}\n\n\t\tlet version = Number.parseInt(val, 10);\n\n\t\tlet subvers = sort_subvers(sub_versions.find((x) => x.type === version).versions);\n\t\tpopulate_dropdown(\n\t\t\tsub_version_el,\n\t\t\tsubvers.map((x) => [x, x])\n\t\t);\n\t});\n\n\t// sort field and order\n\tpopulate_dropdown(sort_field_el, SORT_FIELDS, \"Total Downloads\");\n\tpopulate_dropdown(sort_order_el, SORT_ORDERS, \"desc\");\n\n\t/* prefill forms based on query params*/\n\tfunction prefill_forms() {\n\t\tshould_update = false;\n\t\tlet params = new URLSearchParams(window.location.search);\n\n\t\t// prefill search form\n\t\tfor (let control of search_form.elements) {\n\t\t\tif (params.has(control.name)) {\n\t\t\t\tcontrol.value = params.get(control.name);\n\t\t\t\tcontrol.dispatchEvent(new Event(\"change\"));\n\t\t\t}\n\t\t}\n\n\t\t// prefill page selector\n\t\tif (params.has(\"page\")) {\n\t\t\tfor (let page_el of page_els) {\n\t\t\t\tpage_el.value = params.get(\"page\") + 1;\n\t\t\t}\n\t\t}\n\n\t\t// prefill visual filters\n\t\tif (params.has(\"filtersInclude\")) {\n\t\t\tlet filters = params.get(\"filtersInclude\").split(\" \");\n\t\t\tfor (let control of filters_el.elements) {\n\t\t\t\tif (filters.includes(control.value)) {\n\t\t\t\t\tcontrol.checked = true;\n\t\t\t\t\tcontrol.dataset.value = \"include\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (params.has(\"filtersExclude\")) {\n\t\t\tlet filters = params.get(\"filtersExclude\").split(\" \");\n\t\t\tfor (let control of filters_el.elements) {\n\t\t\t\tif (filters.includes(control.value)) {\n\t\t\t\t\tcontrol.indeterminate = true;\n\t\t\t\t\tcontrol.checked = true;\n\t\t\t\t\tcontrol.dataset.value = \"exclude\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tshould_update = true;\n\t}\n\n\tprefill_forms();\n\n\t// back + forward history buttons\n\twindow.addEventListener(\"popstate\", function () {\n\t\treset_form();\n\t\tprefill_forms();\n\t\tupdate_results(\"popstate\");\n\t});\n\n\t/* \"show project ids\" checkbox*/\n\tshow_ids.checked = localStorage.getItem(\"show_ids\") === \"true\";\n\tif (show_ids.checked) {\n\t\tresults_el.classList.add(\"show-ids\");\n\t}\n\tshow_ids.addEventListener(\"change\", function () {\n\t\tlocalStorage.setItem(\"show_ids\", show_ids.checked);\n\t\tresults_el.classList.toggle(\"show-ids\");\n\t});\n\n\t/* override step validation for page size in search form*/\n\t// based on https://stackoverflow.com/a/51585161\n\tpage_size_el.addEventListener(\"invalid\", function (event) {\n\t\tlet el = event.target;\n\t\tfor (let state in el.validity) {\n\t\t\tif (state == \"stepMismatch\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (el.validity[state]) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tevent.preventDefault();\n\t\treset_page();\n\t\tupdate_results(\"control_change\");\n\t});\n\n\t/* reset page numbering when query changes*/\n\tfunction reset_page() {\n\t\tpage = 0;\n\t\tfor (let el of page_els) {\n\t\t\tel.value = 1;\n\t\t}\n\t}\n\n\t/* reset form*/\n\tfunction reset_form() {\n\t\tfor (let control of search_form.elements) {\n\t\t\tif (control.dataset.default !== undefined) {\n\t\t\t\tcontrol.value = control.dataset.default;\n\t\t\t} else if (control.type === \"text\") {\n\t\t\t\tcontrol.value = \"\";\n\t\t\t}\n\t\t}\n\n\t\tfor (let control of filters_el.elements) {\n\t\t\tcontrol.dataset.value = \"off\";\n\t\t\tcontrol.checked = false;\n\t\t\tcontrol.indeterminate = false;\n\t\t}\n\n\t\tfor (let page_el of page_els) {\n\t\t\tpage_el.value = 1;\n\t\t}\n\n\t\tdisable_modloader();\n\t}\n\n\treset_button.addEventListener(\"click\", function (event) {\n\t\tevent.preventDefault();\n\t\thistory.pushState({}, \"\", window.location.pathname);\n\t\treset_form();\n\t\tupdate_results(\"reset\");\n\t});\n\n\t/* handle results updates */\n\n\t// update results if form is submitted\n\tsearch_form.addEventListener(\"submit\", function (event) {\n\t\tevent.preventDefault();\n\n\t\tif (current_updating_event !== \"control_change\") {\n\t\t\treset_page();\n\t\t\tupdate_results(\"form_submit\");\n\t\t}\n\t});\n\n\t// update results when page changes\n\tfor (let page_el of page_els) {\n\t\tpage_el.addEventListener(\"change\", function (event) {\n\t\t\tif (!page_el.reportValidity()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpage = Number.parseInt(event.target.value, 10) - 1;\n\n\t\t\tfor (let page_el2 of page_els) {\n\t\t\t\tpage_el2.value = page + 1;\n\t\t\t}\n\n\t\t\tlet params = new URLSearchParams(window.location.search);\n\t\t\tparams.set(\"page\", page);\n\t\t\thistory.pushState({}, \"\", \"?\" + params);\n\n\t\t\tupdate_results(\"page_change\");\n\t\t});\n\t}\n\n\t// update results when dropdowns are changed\n\tfor (let control of search_form.elements) {\n\t\tif (control.type !== \"submit\") {\n\t\t\tcontrol.addEventListener(\"change\", function (event) {\n\t\t\t\tif (event.target.form.reportValidity() && should_update) {\n\t\t\t\t\treset_page();\n\t\t\t\t\tupdate_results(\"control_change\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t// fetch default results\n\tupdate_results(\"default\");\n\n\t// allow \"change\" events to call update_results\n\tshould_update = true;\n})();\n"],"names":["GAME_ID","MODLOADERS","map","v","i","SORT_FIELDS","SORT_ORDERS","group_by","xs","key","reduce","rv","x","push","format_categories","array","class_id","subcategories","top_level","sort","a","b","name","localeCompare","undefined","numeric","id","subcategory","Object","entries","parseInt","forEach","findIndex","splice","async","cf_api","endpoint","params","additional_args","URLSearchParams","startsWith","slice","fetch","headers","accept","then","resp","json","data","populate_dropdown","dropdown","values","defaultValue","innerHTML","fragment","document","createDocumentFragment","value","option","createElement","textContent","append","defaultOption","selected","dataset","default","prepend","Array","from","options","find","dispatchEvent","Event","fetch_categories","categories","gameId","classes","brokenClasses","filter","includes","class_","brokenModCategories","Set","has","fetch_vers","filters_el","checked_callback","category","el","checkbox","type","addEventListener","event","target","indeterminate","checked","window","location","search","include","exclude","get_active_filters","set","join","history","pushState","label","createTextNode","filters","elements","pass","fail","e","idx","arr","partition","search_results","current_ac","current_updating_event","populate_results","results_el","results","show_ids","length","result","every","filter_results","li","className","title","href","links","websiteUrl","secondary","downloads","number","downloadCount","toString","toFixed","updated","Date","dateModified","toLocaleDateString","created","dateCreated","summary","url","img","src","iconUrl","logo","thumbnailUrl","alt","populate_results_delayed","setTimeout","by_id","getElementById","bind","search_form","classes_el","categories_el","modloader_el","version_el","sub_version_el","sort_field_el","sort_order_el","page_size_el","page_els","getElementsByClassName","loading_indicator","reset_button","update_results","event_name","page","abort","AbortController","FormData","params2","get","delete","hidden","queries","page_size","Number","offset","real_page_size","Math","min","index","signal","query_results","query","query_result","flat","error","populate_filters","should_update","versions","sub_versions","cache_time","localStorage","getItem","now","Promise","all","setItem","JSON","stringify","parse","fetch_dropdown_values","disable_modloader","disabled","update_modloader","prefill_forms","control","page_el","split","reset_page","reset_form","categories2","version","val","subvers","endsWith","sort_subvers","classList","add","toggle","state","validity","preventDefault","pathname","reportValidity","page_el2","form"],"sourceRoot":""}