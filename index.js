!async function(){const e=432,t=["Any","Forge","Cauldron","LiteLoader","Fabric","Quilt"].map(((e,t)=>[e,t])),a=["Featured","Popularity","Last Updated","Name","Author","Total Downloads","Category","Game Version"].map(((e,t)=>[e,t+1])),n=["asc","desc"].map((e=>[e,e]));let l,o=document.getElementById.bind(document),r=o("search-form"),i=o("classes"),c=o("categories"),s=o("modloader"),d=o("version"),u=o("sub-version"),m=o("sort-field"),f=o("sort-order"),p=o("results"),h=o("page-size"),g=document.getElementsByClassName("page"),v=o("loading-indicator"),y=o("reset"),E=o("filters"),w=0,C=!1,L=null,S="";function x(e,t){return e.reduce((function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e}),{})}function I(e,t){let a=x(e,"parentCategoryId"),n=a[t];delete a[t],n.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0})));for(let[e,t]of Object.entries(a)){e=parseInt(e,10),t.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0}))),t.forEach((e=>{e.name=" â”” "+e.name}));let a=n.findIndex((t=>t.id===e));n.splice(a+1,0,...t)}return n}async function b(e,t,a){return"object"!=typeof t||t instanceof URLSearchParams?null==t&&(t=""):t=new URLSearchParams(t),e.startsWith("/")&&(e=e.slice(1)),fetch("https://api.curseforge.com/"+e+"?"+t,{headers:{"x-api-key":"$2a$10$3kFa9lBWciEK.lsp7NyCSupZ3XmlAYixZQ9fTczqsz1/.W9QDnLUy",accept:"application/json"},...a}).then((e=>e.json())).then((e=>e.data))}function D(e,t,a){e.innerHTML="";let n=document.createDocumentFragment();for(let[e,a]of t){let t=document.createElement("option");t.value=a,t.textContent=e,n.appendChild(t)}if(e.appendChild(n),null==a){let t=document.createElement("option");t.value="",t.selected=!0,t.textContent=e.dataset.name,e.dataset.default="",e.prepend(t)}else{let t=Array.from(e.options).find((e=>e.textContent===a));e.dataset.default=t.value,t.selected=!0,e.dispatchEvent(new Event("change"))}}function M(){let e=Array.from(E.elements).filter((e=>e.checked)),[t,a]=function(e,t){let a=[],n=[];return e.forEach(((e,l,o)=>(t(e,l,o)?a:n).push(e))),[a,n]}(e,(e=>"include"===e.dataset.value));return[t.map((e=>parseInt(e.value,10))),a.map((e=>parseInt(e.value,10)))]}let U,N,k,T,F=localStorage.getItem("cache_time"),P=Date.now();if(!F||P-F>864e5){let t=await Promise.all([async function(){let t=await b("/v1/categories",{gameId:e});t=x(t,"classId");let a=t[void 0].sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0})));delete t[void 0];let n=[5,4546,4559,4979];for(let e of n)delete t[e];a=a.filter((e=>!n.includes(e.id)));for(let e in t)t[e]=I(t[e],e);let l=[5192,4780,5190,5129];return t[6]=t[6].filter((e=>!l.includes(e.id))),[a,t]}(),async function(){return function(e){return e.filter((e=>e.name.startsWith("Minecraft"))).sort(((e,t)=>(e=e.name,t=t.name,e.startsWith("Minecraft")?t.startsWith("Minecraft")?"Minecraft Beta"===e?1:"Minecraft Beta"===t?-1:-e.localeCompare(t,void 0,{numeric:!0}):-1:t.startsWith("Minecraft")?1:e.localeCompare(t,void 0,{numeric:!0}))))}(await b("/v1/games/432/version-types"))}(),b("/v1/games/432/versions")]);[[U,N],k,T]=t,localStorage.setItem("cache",JSON.stringify(t)),localStorage.setItem("cache_time",P)}else[[U,N],k,T]=JSON.parse(localStorage.getItem("cache"));function W(){s.title=s.dataset.title,s.disabled=!0}function j(){"6"===i.value&&""!==u.value?(s.title="",s.disabled=!1):W()}function A(){C=!1;let e=new URLSearchParams(window.location.search);for(let t of r.elements)e.has(t.name)&&(t.value=e.get(t.name),t.dispatchEvent(new Event("change")));if(e.has("page"))for(let t of g)t.value=e.get("page");if(e.has("filtersInclude")){let t=e.get("filtersInclude").split(",");for(let e of E.elements)t.includes(e.value)&&(e.checked=!0,e.dataset.value="include")}if(e.has("filtersExclude")){let t=e.get("filtersExclude").split(",");for(let e of E.elements)t.includes(e.value)&&(e.indeterminate=!0,e.checked=!0,e.dataset.value="exclude")}C=!0}function R(){w=0;for(let e of g)e.value=0}function _(){for(let e of r.elements)void 0!==e.dataset.default?e.value=e.dataset.default:"text"===e.type&&(e.value="");for(let e of E.elements)e.dataset.value="off",e.checked=!1,e.indeterminate=!1;W()}async function $(t){null!==L&&L.abort();let a=new AbortController;L=a,S=t;let n=new URLSearchParams(new FormData(r));if(!["default","reset","popstate"].includes(S)){let e=new URLSearchParams(n),[t,a]=M();e.set("filtersInclude",t.join(",")),e.set("filtersExclude",a.join(",")),window.location.search!=="?"+e.toString()&&history.pushState({},"","?"+e.toString())}n.append("gameId",e),n.get("gameVersion")&&"0"===n.get("modLoaderType")&&n.delete("modLoaderType"),v.hidden=!1,p.innerHTML="",l=[];let o=[],i=parseInt(n.get("pageSize"),10);for(let e=0;e<i;e+=50){let t=Math.min(50,i-e),l=new URLSearchParams(n),r=i*w+e;l.set("index",r),l.set("pageSize",t),o.push(b("/v1/mods/search",l,{signal:a.signal}))}try{let e=[];for(let t of o){let a=await t;console.log(a),z(a),e.push(a)}l=e.flat(),v.hidden=!0,L=null,S=null}catch(e){if("AbortError"!==e.name)throw e}}function z(e){let[t,a]=M();e=function(e,t,a){return t.length>0&&(e=e.filter((e=>t.every((t=>e.categories.find((e=>e.id==t))))))),a.length>0&&(e=e.filter((e=>e.categories.every((e=>!a.includes(e.id)))))),e}(e,t,a);let n=document.createDocumentFragment();for(let t of e){let e=document.createElement("li");e.className="result";let a=document.createElement("a");a.className="result-title",a.href=t.links.websiteUrl,a.textContent=t.name;let o=document.createElement("div");o.className="result-secondary";let r=document.createElement("span");r.textContent=`${l=t.downloadCount,l<1e3?l.toString():l<1e6?(l/1e3).toFixed(1)+"K":(l/1e3/1e3).toFixed(1)+"M"} Downloads`;let i=document.createElement("span");i.textContent=`Updated ${new Date(t.dateModified).toLocaleDateString()}`;let c=document.createElement("span");c.textContent=`Created ${new Date(t.dateCreated).toLocaleDateString()}`,o.append(r,i,c);let s=document.createElement("p");s.className="result-summary",s.textContent=t.summary;let d=document.createElement("div");d.className="result-categories";for(let e of t.categories){let t=document.createElement("a");t.href=e.url;let a=document.createElement("img");a.className="result-category-image",a.src=e.iconUrl,a.title=e.name,t.appendChild(a),d.appendChild(t)}let u=document.createElement("img");u.className="result-logo",t.logo&&(u.src=t.logo.thumbnailUrl),u.alt="",e.append(u,d,a,o,s),n.append(e)}var l;p.appendChild(n)}D(c,[]),i.addEventListener("change",(function(){j();let e=i.value,t=N[e].map((e=>[e.name,e.id]));D(c,t),function(e){E.innerHTML="";let t=document.createDocumentFragment();for(let[a,n]of e){let e=document.createElement("label"),o=document.createElement("input");o.type="checkbox",o.name=a,o.value=n,o.addEventListener("change",(function(e){let t=e.target;t.dataset.value&&"off"!==t.dataset.value?"include"===t.dataset.value?(t.indeterminate=!0,t.checked=!0,t.dataset.value="exclude"):(t.checked=!1,t.indeterminate=!1,t.dataset.value="off"):(t.checked=!0,t.indeterminate=!1,t.dataset.value="include");let a=new URLSearchParams(window.location.search),[n,o]=M();a.set("filtersInclude",n.join(",")),a.set("filtersExclude",o.join(",")),history.pushState({},"","?"+a),p.innerHTML="",setTimeout((()=>z(l)),0)}));let r=document.createTextNode(a);e.append(o,r),t.appendChild(e)}E.appendChild(t)}(t)})),D(i,U.map((e=>[e.name,e.id])),"Mods"),D(s,t,"Any"),u.addEventListener("change",(function(){j()})),D(d,k.map((e=>[e.name,e.id]))),D(u,[]),d.addEventListener("change",(function(){let e=d.value;if(""===e)return void D(u,[]);let t=parseInt(e,10),a=function(e){return e.sort(((e,t)=>e.endsWith("Snapshot")?1:t.endsWith("Snapshot")?-1:-e.localeCompare(t,void 0,{numeric:!0})))}(T.find((e=>e.type===t)).versions);D(u,a.map((e=>[e,e]))),W()})),D(m,a,"Total Downloads"),D(f,n,"desc"),A(),window.addEventListener("popstate",(function(){_(),A(),$("popstate")})),h.addEventListener("invalid",(function(e){let t=e.target;for(let e in t.validity)if("stepMismatch"!=e&&t.validity[e])return;e.preventDefault(),R(),$("control_change")})),y.addEventListener("click",(function(e){e.preventDefault(),history.pushState({},"",window.location.pathname),_(),$("reset")})),r.addEventListener("submit",(function(e){e.preventDefault(),"control_change"!==S&&(R(),$("form_submit"))}));for(let e of g)e.addEventListener("change",(function(e){w=parseInt(e.target.value,10);for(let e of g)e.value=w;let t=new URLSearchParams(window.location.search);t.set("page",w),history.pushState({},"","?"+t),$("page_change")}));for(let e of r.elements)"submit"!==e.type&&e.addEventListener("change",(function(e){e.target.form.reportValidity()&&C&&(R(),$("control_change"))}));$("default"),C=!0}();