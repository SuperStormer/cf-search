(()=>{"use strict";const e="$2a$10$3kFa9lBWciEK.lsp7NyCSupZ3XmlAYixZQ9fTczqsz1/.W9QDnLUy",t=432,a=[["Any",0],["Forge",1],["Fabric",4],["Quilt",5],["NeoForge",6]],n=["Featured","Popularity","Last Updated","Name","Author","Total Downloads","Category","Game Version"].map(((e,t)=>[e,t+1])),l=["asc","desc"].map((e=>[e,e]));function r(e,t){return e.reduce((function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e}),{})}function o(e,t){return e.localeCompare(t,"en",{numeric:!0})}function s(e,t){let a=r(e,"parentCategoryId"),n=a[t];delete a[t],n.sort(((e,t)=>o(e.name,t.name)));for(let[e,t]of Object.entries(a)){e=parseInt(e,10),t.sort(((e,t)=>o(e.name,t.name))),t.forEach((e=>{e.name=" â”” "+e.name}));let a=n.findIndex((t=>t.id===e));n.splice(a+1,0,...t)}return n}async function i(t,a,n){return"object"!=typeof a||a instanceof URLSearchParams?null==a&&(a=""):a=new URLSearchParams(a),t.startsWith("/")&&(t=t.slice(1)),fetch("https://api.curseforge.com/"+t+"?"+a,{headers:{"x-api-key":e,accept:"application/json"},...n}).then((e=>e.json())).then((e=>e.data))}function c(e,t,a){e.innerHTML="";let n=document.createDocumentFragment();for(let[e,a]of t){let t=document.createElement("option");t.value=a,t.textContent=e,n.append(t)}if(e.append(n),null==a){let t=document.createElement("option");t.value="",t.selected=!0,t.textContent=e.dataset.name,e.dataset.default="",e.prepend(t)}else{let t=Array.from(e.options).find((e=>e.textContent===a));e.dataset.default=t.value,t.selected=!0,e.dispatchEvent(new Event("change"))}}async function d(){let e=await i("/v1/categories",{gameId:t});e=r(e,"classId");let a=e[void 0].sort(((e,t)=>o(e.name,t.name)));delete e[void 0];let n=[5,4546,4559,4979,6552];for(let t of n)delete e[t];a=a.filter((e=>!n.includes(e.id)));for(let t in e)e[t]=s(e[t],t);let l=[5192,4780,5190,5129];return e[6]=e[6].filter((e=>!l.includes(e.id))),[a,e]}async function u(){return(await i(`/v1/games/${t}/version-types`)).filter((e=>e.name.startsWith("Minecraft"))).sort(((e,t)=>(e=e.name,t=t.name,e.startsWith("Minecraft")?t.startsWith("Minecraft")?"Minecraft Beta"===e?1:"Minecraft Beta"===t?-1:-o(e,t):-1:t.startsWith("Minecraft")?1:o(e,t))))}function m(e,t,a){e.innerHTML="";let n=document.createDocumentFragment();for(let[e,l]of t){let t=document.createElement("label");t.className="checkbox-label";let r=document.createElement("input");r.type="checkbox",r.name=e,r.value=l,r.addEventListener("change",(function(e){let t=e.target;t.dataset.value&&"off"!==t.dataset.value?"include"===t.dataset.value?(t.indeterminate=!0,t.checked=!0,t.dataset.value="exclude"):(t.checked=!1,t.indeterminate=!1,t.dataset.value="off"):(t.checked=!0,t.indeterminate=!1,t.dataset.value="include"),a()}));let o=document.createTextNode(e);t.append(r,o),n.append(t)}e.append(n)}function f(e,t){let a=Array.from(e.elements).filter((e=>e.checked)),[n,l]=function(e,t){let a=[],n=[];return e.forEach(((e,l,r)=>(t(e,l,r)?a:n).push(e))),[a,n]}(a,(e=>"include"===e.dataset.value));[n,l]=[n.map((e=>parseInt(e.value,10))),l.map((e=>parseInt(e.value,10)))];let[r,o]=Array.from(t).map((e=>e.value));return[n,l,o,r]}function h(e,t){let a=new URLSearchParams(e),[n,l,r,o]=t;a.set("filtersInclude",n.join(" ")),a.set("filtersExclude",l.join(" ")),a.set("maxVer",r),a.set("minVer",o),window.location.search!=="?"+a.toString()&&history.pushState({},"","?"+a.toString())}let p=[],g=null,v="";function w(e,t,a){a=function(e,t){let[a,n,l,r]=t;return a.length>0&&(e=e.filter((e=>a.every((t=>e.categories.find((e=>e.id==t))))))),n.length>0&&(e=e.filter((e=>e.categories.every((e=>!n.includes(e.id)))))),l.length>0&&(2===l.split(".").length&&(l+="a"),e=e.filter((e=>e.latestFilesIndexes.some((e=>o(e.gameVersion,l)<=0))))),r.length>0&&(e=e.filter((e=>e.latestFilesIndexes.some((e=>o(e.gameVersion,r)>=0))))),e}(a,t);let n=new URLSearchParams(window.location.search),l=document.createDocumentFragment();for(let e of a){let t=document.createElement("li");t.className="result";let a=document.createElement("div");a.className="result-title";let o=document.createElement("a");o.className="result-title-link";let s=new URL(e.links.websiteUrl);if(s.hostname="www.curseforge.com",o.href=s,o.textContent=e.name,a.append(o),e.authors.length>0){let t=document.createElement("span");t.className="result-author";let n=document.createElement("a");n.className="result-author-link",n.href=e.authors[0].url,n.textContent=e.authors[0].name,t.append("by",n),a.append(t)}let i=document.createElement("div");i.className="result-subtitle";let c=document.createElement("span");c.textContent=`${r=e.downloadCount,r<1e3?r.toString():r<1e6?(r/1e3).toFixed(1)+"K":(r/1e3/1e3).toFixed(1)+"M"} Downloads`;let d=document.createElement("span");d.textContent=`Updated ${new Date(e.dateModified).toLocaleDateString()}`;let u=document.createElement("span");u.textContent=`Created ${new Date(e.dateCreated).toLocaleDateString()}`,i.append(c,d,u);let m=document.createElement("p");m.className="result-summary",m.textContent=e.summary;let f=document.createElement("div");f.className="result-categories";for(let t of e.categories){let e=document.createElement("a");e.href=t.url;let a=document.createElement("img");a.className="result-category-image",a.src=t.iconUrl,a.title=t.name,e.append(a),f.append(e)}let h=document.createElement("span");h.className="result-project-id",h.textContent=`Project ID: ${e.id}`;let p=document.createElement("a");p.className="download-button",p.href=y(e,n);let g=document.createElement("button");g.textContent="Download",p.append(g);let v=document.createElement("img");v.className="result-logo",e.logo&&(v.src=e.logo.thumbnailUrl),v.alt="",t.append(v,f,p,h,a,i,m),l.append(t)}var r;e.append(l)}function y(e,t){let a="6"===t.get("classId"),n="4471"===t.get("classId"),l=t.get("gameVersion"),r=Number.parseInt(t.get("gameVersionTypeId"),10),s=Number.parseInt(t.get("modLoaderType"),10);if(a&&t.get("gameVersion")&&t.get("gameVersionTypeId")&&t.has("modLoaderType")&&"0"!==t.get("modLoaderType")){let t=o(l,"1.14")<0&&1===s;try{let a=e.latestFilesIndexes.find((e=>e.gameVersionTypeId===r&&e.gameVersion===l&&(e.modLoader===s||null===e.modLoader&&t))).fileId;return`${e.links.websiteUrl}/download/${a}/file`}catch(e){TypeError}}else if(n)try{let t=e.latestFilesIndexes.find((e=>(Number.isNaN(r)||e.gameVersionTypeId===r)&&(""===l||e.gameVersion===l))).fileId;return`${e.links.websiteUrl}/download/${t}/file`}catch(e){TypeError}else if(!a&&!n&&t.get("gameVersion")&&t.get("gameVersionTypeId"))try{let t=e.latestFilesIndexes.find((e=>e.gameVersionTypeId===r&&e.gameVersion===l)).fileId;return`${e.links.websiteUrl}/download/${t}/file`}catch(e){TypeError}return`${e.links.websiteUrl}/files/all`}!async function(){const e=document.getElementById.bind(document),r=e("search-form"),s=e("classes"),y=e("categories"),E=e("modloader"),I=e("version"),L=e("sub-version"),x=e("sort-field"),b=e("sort-order"),S=e("page-size"),N=e("reset"),k=document.getElementsByClassName("page"),V=e("loading-indicator"),C=e("results"),T=e("sidebar"),U=e("filters"),D=document.getElementsByClassName("version-filter"),F=e("show-filters"),$=e("show-id"),M=e("show-author"),P=e=>{!async function(e,a,n,l,r,o){let s=new URLSearchParams(n),c=Number.parseInt(s.get("pageSize"),10);if(c*(r+1)>1e4)alert("The desired page is too large for the Curseforge API");else{null!==g&&g.abort(),g=new AbortController,v=o,"control_change"==v&&h(s,l),s.append("gameId",t),s.get("gameVersion")&&"0"===s.get("modLoaderType")&&s.delete("modLoaderType"),a.hidden=!1,e.innerHTML="",p=[];try{let t=[];for(let e=0;e<c;e+=50){let a=Math.min(50,c-e),n=new URLSearchParams(s),l=c*r+e;n.set("index",l),n.set("pageSize",a),t.push(i("/v1/mods/search",n,{signal:g.signal}))}let n=[];for(let a of t){let t=await a;w(e,l,t),n.push(t)}p=n.flat(),a.hidden=!0,g=null,v=null}catch(e){if("AbortError"!==e.name)throw e}}}(C,V,new FormData(r),f(U,D),A,e)},_=m.bind(m,U);let A=0,R=!1,[W,j,B,z]=await async function(){let e,a,n,l,r=localStorage.getItem("cache_time"),o=Date.now();if(!r||o-r>864e5){let r=await Promise.all([d(),u(),i(`/v1/games/${t}/versions`)]);[[e,a],n,l]=r,localStorage.setItem("cache",JSON.stringify(r)),localStorage.setItem("cache_time",o)}else[[e,a],n,l]=JSON.parse(localStorage.getItem("cache"));return[e,a,n,l]}();function H(){E.title=E.dataset.title,E.disabled=!0}function O(){"6"===s.value&&""!==L.value?(E.title="",E.disabled=!1):H()}function Q(){R=!1;let e=new URLSearchParams(window.location.search);for(let t of r.elements)e.has(t.name)&&(t.value=e.get(t.name),t.dispatchEvent(new Event("change")));if(e.has("page"))for(let t of k)t.value=e.get("page")+1;if(e.has("filtersInclude")){let t=e.get("filtersInclude").split(" ");for(let e of U.elements)t.includes(e.value)&&(e.checked=!0,e.dataset.value="include")}if(e.has("filtersExclude")){let t=e.get("filtersExclude").split(" ");for(let e of U.elements)t.includes(e.value)&&(e.indeterminate=!0,e.checked=!0,e.dataset.value="exclude")}e.has("minVer")&&(D[0].value=e.get("minVer")),e.has("maxVer")&&(D[1].value=e.get("maxVer")),R=!0}function J(){let e=f(U,D);h(window.location.search,e),function(e,t){e.innerHTML="",setTimeout((()=>w(e,t,p)),0)}(C,e)}c(y,[]),s.addEventListener("change",(function(){O();let e=s.value,t=j[e].map((e=>[e.name,e.id]));c(y,t),_(t,J)})),c(s,W.map((e=>[e.name,e.id])),"Mods"),c(E,a,"Any"),L.addEventListener("change",(function(){O()})),c(I,B.map((e=>[e.name,e.id]))),c(L,[]),I.addEventListener("change",(function(){H();let e=I.value;if(""===e)return void c(L,[]);let t=Number.parseInt(e,10),a=function(e){return e.sort(((e,t)=>e.endsWith("Snapshot")?1:t.endsWith("Snapshot")?-1:-o(e,t)))}(z.find((e=>e.type===t)).versions);c(L,a.map((e=>[e,e])))})),c(x,n,"Total Downloads"),c(b,l,"desc"),Q(),window.addEventListener("popstate",(function(){Z(),Q(),P("popstate")})),$.checked="true"===localStorage.getItem("show_id"),$.checked&&C.classList.add("show-id"),$.addEventListener("change",(function(){localStorage.setItem("show_id",$.checked),C.classList.toggle("show-id")})),M.checked="true"===localStorage.getItem("show_author"),M.checked&&C.classList.add("show-author"),M.addEventListener("change",(function(){localStorage.setItem("show_author",M.checked),C.classList.toggle("show-author")}));for(let e of D)e.addEventListener("change",(function(){e.reportValidity()&&J()}));function K(){A=0;for(let e of k)e.value=1}function Z(){for(let e of r.elements)void 0!==e.dataset.default?e.value=e.dataset.default:"text"===e.type&&(e.value="");for(let e of U.elements)e.dataset.value="off",e.checked=!1,e.indeterminate=!1;for(let e of D)e.value="";for(let e of k)e.value=1;H()}F.addEventListener("click",(function(){T.classList.toggle("show-filters")?F.textContent="Hide":F.textContent="Show"})),S.addEventListener("invalid",(function(e){let t=e.target;for(let e in t.validity)if("stepMismatch"!=e&&t.validity[e])return;e.preventDefault(),K(),P("control_change")})),N.addEventListener("click",(function(e){e.preventDefault(),history.pushState({},"",window.location.pathname),Z(),P("reset")})),r.addEventListener("submit",(function(e){e.preventDefault(),"control_change"!==v&&(K(),P("form_submit"))}));for(let e of k)e.addEventListener("change",(function(t){if(!e.reportValidity())return;A=Number.parseInt(t.target.value,10)-1;for(let e of k)e.value=A+1;let a=new URLSearchParams(window.location.search);a.set("page",A),history.pushState({},"","?"+a),P("page_change")}));for(let e of r.elements)"submit"!==e.type&&e.addEventListener("change",(function(e){e.target.form.reportValidity()&&R&&(K(),P("control_change"))}));P("default"),R=!0}()})();
//# sourceMappingURL=index.js.map