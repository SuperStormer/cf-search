(()=>{"use strict";const e=432,t=["Any","Forge","Cauldron","LiteLoader","Fabric","Quilt"].map(((e,t)=>[e,t])),a=["Featured","Popularity","Last Updated","Name","Author","Total Downloads","Category","Game Version"].map(((e,t)=>[e,t+1])),n=["asc","desc"].map((e=>[e,e]));function l(e,t){return e.reduce((function(e,a){return(e[a[t]]=e[a[t]]||[]).push(a),e}),{})}function o(e,t){let a=l(e,"parentCategoryId"),n=a[t];delete a[t],n.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0})));for(let[e,t]of Object.entries(a)){e=parseInt(e,10),t.sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0}))),t.forEach((e=>{e.name=" â”” "+e.name}));let a=n.findIndex((t=>t.id===e));n.splice(a+1,0,...t)}return n}async function r(e,t,a){return"object"!=typeof t||t instanceof URLSearchParams?null==t&&(t=""):t=new URLSearchParams(t),e.startsWith("/")&&(e=e.slice(1)),fetch("https://api.curseforge.com/"+e+"?"+t,{headers:{"x-api-key":"$2a$10$3kFa9lBWciEK.lsp7NyCSupZ3XmlAYixZQ9fTczqsz1/.W9QDnLUy",accept:"application/json"},...a}).then((e=>e.json())).then((e=>e.data))}function i(e,t,a){e.innerHTML="";let n=document.createDocumentFragment();for(let[e,a]of t){let t=document.createElement("option");t.value=a,t.textContent=e,n.append(t)}if(e.append(n),null==a){let t=document.createElement("option");t.value="",t.selected=!0,t.textContent=e.dataset.name,e.dataset.default="",e.prepend(t)}else{let t=Array.from(e.options).find((e=>e.textContent===a));e.dataset.default=t.value,t.selected=!0,e.dispatchEvent(new Event("change"))}}async function s(){let t=await r("/v1/categories",{gameId:e});t=l(t,"classId");let a=t[void 0].sort(((e,t)=>e.name.localeCompare(t.name,void 0,{numeric:!0})));delete t[void 0];let n=[5,4546,4559,4979];for(let e of n)delete t[e];a=a.filter((e=>!n.includes(e.id)));for(let e in t)t[e]=o(t[e],e);let i=new Set([5192,4780,5190,5129]);return t[6]=t[6].filter((e=>!i.has(e.id))),[a,t]}async function c(){return(await r("/v1/games/432/version-types")).filter((e=>e.name.startsWith("Minecraft"))).sort(((e,t)=>(e=e.name,t=t.name,e.startsWith("Minecraft")?t.startsWith("Minecraft")?"Minecraft Beta"===e?1:"Minecraft Beta"===t?-1:-e.localeCompare(t,void 0,{numeric:!0}):-1:t.startsWith("Minecraft")?1:e.localeCompare(t,void 0,{numeric:!0}))))}function d(e,t,a){e.innerHTML="";let n=document.createDocumentFragment();for(let[l,o]of t){let t=document.createElement("label"),r=document.createElement("input");r.type="checkbox",r.name=l,r.value=o,r.addEventListener("change",(function(t){let n=t.target;n.dataset.value&&"off"!==n.dataset.value?"include"===n.dataset.value?(n.indeterminate=!0,n.checked=!0,n.dataset.value="exclude"):(n.checked=!1,n.indeterminate=!1,n.dataset.value="off"):(n.checked=!0,n.indeterminate=!1,n.dataset.value="include");let l=new URLSearchParams(window.location.search),[o,r]=u(e);l.set("filtersInclude",o.join(" ")),l.set("filtersExclude",r.join(" ")),history.pushState({},"","?"+l),a()}));let i=document.createTextNode(l);t.append(r,i),n.append(t)}e.append(n)}function u(e){let t=Array.from(e.elements).filter((e=>e.checked)),[a,n]=function(e,t){let a=[],n=[];return e.forEach(((e,l,o)=>(t(e,l,o)?a:n).push(e))),[a,n]}(t,(e=>"include"===e.dataset.value));return[a.map((e=>parseInt(e.value,10))),n.map((e=>parseInt(e.value,10)))]}let m=[],f=null,p="";function h(e,t,a){let[n,l]=u(t);a=function(e,t,a){return t.length>0&&(e=e.filter((e=>t.every((t=>e.categories.find((e=>e.id==t))))))),a.length>0&&(e=e.filter((e=>e.categories.every((e=>!a.includes(e.id)))))),e}(a,n,l);let o=new URLSearchParams(window.location.search),r=document.createDocumentFragment();for(let e of a){let t=document.createElement("li");t.className="result";let a=document.createElement("a");a.className="result-title",a.href=e.links.websiteUrl,a.textContent=e.name;let n=document.createElement("div");n.className="result-secondary";let l=document.createElement("span");l.textContent=`${i=e.downloadCount,i<1e3?i.toString():i<1e6?(i/1e3).toFixed(1)+"K":(i/1e3/1e3).toFixed(1)+"M"} Downloads`;let s=document.createElement("span");s.textContent=`Updated ${new Date(e.dateModified).toLocaleDateString()}`;let c=document.createElement("span");c.textContent=`Created ${new Date(e.dateCreated).toLocaleDateString()}`,n.append(l,s,c);let d=document.createElement("p");d.className="result-summary",d.textContent=e.summary;let u=document.createElement("div");u.className="result-categories";for(let t of e.categories){let e=document.createElement("a");e.href=t.url;let a=document.createElement("img");a.className="result-category-image",a.src=t.iconUrl,a.title=t.name,e.append(a),u.append(e)}let m,f=document.createElement("span");f.className="project-id",f.textContent=`Project ID: ${e.id}`;let p="6"===o.get("classId"),h=o.get("gameVersion");if(o.get("gameVersion")&&o.get("gameVersionTypeId")&&(!p||o.has("modLoaderType")&&"0"!==o.get("modLoaderType"))){let t=Number.parseInt(o.get("gameVersionTypeId"),10),a=Number.parseInt(o.get("modLoaderType"),10),n=h<"1.14"&&1===a,l=e.latestFilesIndexes.find((e=>e.gameVersion===h&&e.gameVersionTypeId===t&&(!p||e.modLoader===a||null===e.modLoader&&n))).fileId;m=`${e.links.websiteUrl}/download/${l}/file`}else m=`${e.links.websiteUrl}/files/all`;let g=document.createElement("a");g.className="download-button",g.href=m;let v=document.createElement("button");v.textContent="Download",g.append(v);let w=document.createElement("img");w.className="result-logo",e.logo&&(w.src=e.logo.thumbnailUrl),w.alt="",t.append(w,u,g,f,a,n,d),r.append(t)}var i;e.append(r)}!async function(){const l=document.getElementById.bind(document),o=l("search-form"),g=l("classes"),v=l("categories"),w=l("modloader"),y=l("version"),E=l("sub-version"),L=l("sort-field"),S=l("sort-order"),I=l("results"),b=l("page-size"),x=document.getElementsByClassName("page"),C=l("loading-indicator"),N=l("reset"),k=l("filters"),D=l("show-ids"),T=l("show-filters"),U=l("sidebar"),M=t=>{!async function(t,a,n,l,o,i){null!==f&&f.abort(),f=new AbortController,p=i;let s=new URLSearchParams(new FormData(a));if(!["default","reset","popstate"].includes(p)){let e=new URLSearchParams(s),[t,a]=u(n);e.set("filtersInclude",t.join(" ")),e.set("filtersExclude",a.join(" ")),window.location.search!=="?"+e.toString()&&history.pushState({},"","?"+e.toString())}s.append("gameId",e),s.get("gameVersion")&&"0"===s.get("modLoaderType")&&s.delete("modLoaderType"),l.hidden=!1,t.innerHTML="",m=[];try{let e=[],a=Number.parseInt(s.get("pageSize"),10);for(let t=0;t<a;t+=50){let n=Math.min(50,a-t),l=new URLSearchParams(s),i=a*o+t;l.set("index",i),l.set("pageSize",n),e.push(r("/v1/mods/search",l,{signal:f.signal}))}let i=[];for(let a of e){let e=await a;h(t,n,e),i.push(e)}m=i.flat(),l.hidden=!0,f=null,p=null}catch(e){if("AbortError"!==e.name)throw e}}(I,o,k,C,F,t)},P=d.bind(d,k);let F=0,j=!1,[V,$,R,W]=await async function(){let e,t,a,n,l=localStorage.getItem("cache_time"),o=Date.now();if(!l||o-l>864e5){let l=await Promise.all([s(),c(),r("/v1/games/432/versions")]);[[e,t],a,n]=l,localStorage.setItem("cache",JSON.stringify(l)),localStorage.setItem("cache_time",o)}else[[e,t],a,n]=JSON.parse(localStorage.getItem("cache"));return[e,t,a,n]}();function _(){w.title=w.dataset.title,w.disabled=!0}function A(){"6"===g.value&&""!==E.value?(w.title="",w.disabled=!1):_()}function z(){j=!1;let e=new URLSearchParams(window.location.search);for(let t of o.elements)e.has(t.name)&&(t.value=e.get(t.name),t.dispatchEvent(new Event("change")));if(e.has("page"))for(let t of x)t.value=e.get("page")+1;if(e.has("filtersInclude")){let t=e.get("filtersInclude").split(" ");for(let e of k.elements)t.includes(e.value)&&(e.checked=!0,e.dataset.value="include")}if(e.has("filtersExclude")){let t=e.get("filtersExclude").split(" ");for(let e of k.elements)t.includes(e.value)&&(e.indeterminate=!0,e.checked=!0,e.dataset.value="exclude")}j=!0}function B(){F=0;for(let e of x)e.value=1}function H(){for(let e of o.elements)void 0!==e.dataset.default?e.value=e.dataset.default:"text"===e.type&&(e.value="");for(let e of k.elements)e.dataset.value="off",e.checked=!1,e.indeterminate=!1;for(let e of x)e.value=1;_()}i(v,[]),g.addEventListener("change",(function(){A();let e=g.value,t=$[e].map((e=>[e.name,e.id]));i(v,t),P(t,(()=>{!function(e,t){e.innerHTML="",setTimeout((()=>h(e,t,m)),0)}(I,k)}))})),i(g,V.map((e=>[e.name,e.id])),"Mods"),i(w,t,"Any"),E.addEventListener("change",(function(){A()})),i(y,R.map((e=>[e.name,e.id]))),i(E,[]),y.addEventListener("change",(function(){_();let e=y.value;if(""===e)return void i(E,[]);let t=Number.parseInt(e,10),a=function(e){return e.sort(((e,t)=>e.endsWith("Snapshot")?1:t.endsWith("Snapshot")?-1:-e.localeCompare(t,void 0,{numeric:!0})))}(W.find((e=>e.type===t)).versions);i(E,a.map((e=>[e,e])))})),i(L,a,"Total Downloads"),i(S,n,"desc"),z(),window.addEventListener("popstate",(function(){H(),z(),M("popstate")})),D.checked="true"===localStorage.getItem("show_ids"),D.checked&&I.classList.add("show-ids"),D.addEventListener("change",(function(){localStorage.setItem("show_ids",D.checked),I.classList.toggle("show-ids")})),T.addEventListener("click",(function(){U.classList.toggle("show-filters")?T.textContent="Hide":T.textContent="Show"})),b.addEventListener("invalid",(function(e){let t=e.target;for(let e in t.validity)if("stepMismatch"!=e&&t.validity[e])return;e.preventDefault(),B(),M("control_change")})),N.addEventListener("click",(function(e){e.preventDefault(),history.pushState({},"",window.location.pathname),H(),M("reset")})),o.addEventListener("submit",(function(e){e.preventDefault(),"control_change"!==p&&(B(),M("form_submit"))}));for(let e of x)e.addEventListener("change",(function(t){if(!e.reportValidity())return;F=Number.parseInt(t.target.value,10)-1;for(let e of x)e.value=F+1;let a=new URLSearchParams(window.location.search);a.set("page",F),history.pushState({},"","?"+a),M("page_change")}));for(let e of o.elements)"submit"!==e.type&&e.addEventListener("change",(function(e){e.target.form.reportValidity()&&j&&(B(),M("control_change"))}));M("default"),j=!0}()})();
//# sourceMappingURL=index.js.map